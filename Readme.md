Bam coverage, Peak and Enhancer-like (BPE) analysis
=============================================

This set of code is to analyse enhancer-like elememts using ChIpseq and other assays.
The code is in early stage of development, not suitable for use beyond the author.

Input data for this analysis includes peak calls and bam coverage counts 
generated from related github repositories for [Chipseq_pipeline](https://github.com/LucyJoy12/Scripts) and [LC_Scripts](https://github.com/mikej100/lc_scripts).


`inspect_multicov` is used to assimilate ChIPseq data generated by `multibw_pipeline` in the  [Chipseq_pipeline](https://github.com/LucyJoy12/Scripts) repository.

Installation
============

One time set up
--------------

Set up a directory structure in you code development space for the repository. 
This can be a different location to the input and output data. 
For example `/project/<group>/<user>/dev/bpe-1_20240605

`cd` to this directory and clone this github repository to there.

```
/project/<group>/<user>/dev/
├── bpe-1_20240605
│   └── bpe-1
│       ├── config.yml
│       └── R


```

In `config.yml` configure the directory where the analysis input and output data resides. This is structured to be consistent with the Chipseq and multibw pipelines where there is a project directory, a subdirectory for tissue type and subdirectories of that for assay data and data analysis (see 
[Chipseq_pipeline](https://github.com/LucyJoy12/Scripts))

for example:
```
default:
  proj_path: /project/<group>/<user>/proj/<project-name>
  model_dir: ter119_APH_spleen
  analysis_dir: ana_1
  mcov_file:
    - mbws_ATAC.tab
    - mbws_histone.tab
    - mbws_cf.tab
```

Clone this repository into a folder such as `/project/<group>/<user>/dev/pipelines`

`cd` to the directory created

Create conda environment

    mamba env create environment.yml 

Create aliases to activate environment in `~/.bash_aliases`
```
  # Create an alias to load conda/mamba
    alias load_mamba='source /project/<group>/<user>/mamba_installation/conda/etc/profile.d/conda.sh && source /project/<group>/<user>/mamba_installation/conda/etc/profile.d/mamba.sh && mamba activate base'
```
Running
=======

You can run the code from the development directory


```
source ~/.env
load_mamba
mamba activate bpe_env
```
